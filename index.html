<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¾è‚¡æˆæœ¬èˆ‡å›æœ¬è¨ˆç®—æ©Ÿ</title>
    <style>
        :root {
            --primary-color: #0070f3;
            --success-color: #10b981;
            --warning-color: #f5a623;
            --bg-color: #f5f5f5;
            --card-bg: #ffffff;
            --text-color: #333;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }

        .container {
            background-color: var(--card-bg);
            padding: 2rem;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.05);
            width: 100%;
            max-width: 420px;
        }

        h1 {
            text-align: center;
            font-size: 1.5rem;
            margin-bottom: 1.5rem;
            color: var(--text-color);
            font-weight: 700;
        }

        .input-group {
            margin-bottom: 1.2rem;
        }

        label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            font-size: 0.9rem;
            color: #555;
        }

        input {
            width: 100%;
            padding: 12px;
            border: 2px solid #eee;
            border-radius: 8px;
            font-size: 1rem;
            box-sizing: border-box;
            transition: border-color 0.2s;
        }

        input:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .divider {
            height: 1px;
            background-color: #eee;
            margin: 1.5rem 0;
        }

        .result-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.8rem;
            font-size: 0.95rem;
        }

        .result-row.total {
            font-weight: bold;
            font-size: 1.1rem;
            color: var(--text-color);
            margin-top: 10px;
            border-top: 1px dashed #ddd;
            padding-top: 10px;
        }

        /* æ™ºæ…§åˆ†æå€å¡Š */
        .ai-box {
            background: linear-gradient(135deg, #e0f2fe 0%, #f0f9ff 100%);
            border: 1px solid #bae6fd;
            border-radius: 10px;
            padding: 1.2rem;
            margin-top: 1.5rem;
            text-align: center;
        }

        .ai-title {
            font-size: 0.85rem;
            color: #0284c7;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 0.5rem;
        }

        .ai-price {
            font-size: 2rem;
            font-weight: 800;
            color: var(--success-color);
            margin: 0.5rem 0;
        }

        .ai-desc {
            font-size: 0.9rem;
            color: #64748b;
        }

        .highlight {
            color: var(--warning-color);
            font-weight: bold;
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>ğŸ‡ºğŸ‡¸ ç¾è‚¡æ™ºæ…§è©¦ç®—</h1>

        <div class="input-group">
            <label for="price">è²·å…¥è‚¡åƒ¹ (USD)</label>
            <input type="number" id="price" placeholder="ä¾‹å¦‚: 150.5" step="0.01">
        </div>

        <div class="input-group">
            <label for="shares">è‚¡æ•¸</label>
            <input type="number" id="shares" placeholder="ä¾‹å¦‚: 10" step="1">
        </div>

        <div class="input-group">
            <label for="feeRate">é›™å‘æ‰‹çºŒè²»ç‡ (%)</label>
            <input type="number" id="feeRate" value="0.25" step="0.01">
        </div>

        <div class="divider"></div>

        <div class="result-row">
            <span>è‚¡ç¥¨å¸‚å€¼</span>
            <span id="principal">$0.00</span>
        </div>
        <div class="result-row">
            <span>è²·å…¥æ‰‹çºŒè²»</span>
            <span id="buyFee">$0.00</span>
        </div>
        <div class="result-row total">
            <span>è²·å…¥ç¸½æ”¯å‡º</span>
            <span id="totalCost">$0.00</span>
        </div>

        <div class="ai-box">
            <div class="ai-title">ğŸ¤– çœŸæ­£å›æœ¬è³£å‡ºåƒ¹</div>
            <div class="ai-price" id="breakEvenPrice">$0.00</div>
            <div class="ai-desc">
                è‚¡åƒ¹éœ€ä¸Šæ¼² <span id="percentNeed" class="highlight">0.00%</span><br>
                ä»¥æ”¯ä»˜è²·è³£é›™æ–¹æ‰‹çºŒè²»
            </div>
        </div>
    </div>

    <script>
        const priceInput = document.getElementById('price');
        const sharesInput = document.getElementById('shares');
        const feeRateInput = document.getElementById('feeRate');
        
        const principalDisplay = document.getElementById('principal');
        const buyFeeDisplay = document.getElementById('buyFee');
        const totalCostDisplay = document.getElementById('totalCost');
        
        const breakEvenPriceDisplay = document.getElementById('breakEvenPrice');
        const percentNeedDisplay = document.getElementById('percentNeed');

        const inputs = [priceInput, sharesInput, feeRateInput];
        inputs.forEach(input => input.addEventListener('input', calculate));

        function calculate() {
            const price = parseFloat(priceInput.value) || 0;
            const shares = parseFloat(sharesInput.value) || 0;
            const feeRate = parseFloat(feeRateInput.value) || 0;
            
            // è²»ç‡è½‰å°æ•¸ (0.25% -> 0.0025)
            const rateDecimal = feeRate / 100;

            // 1. è²·å…¥è¨ˆç®—
            const principal = price * shares;
            const buyFee = principal * rateDecimal;
            const totalBuyCost = principal + buyFee;

            // 2. æ™ºæ…§å›æœ¬è¨ˆç®— (å«è³£å‡ºè²»)
            // å…¬å¼é‚è¼¯ï¼šè³£å‡ºç¸½æ‹¿å›é‡‘é¡ = è³£å‡ºç¸½åƒ¹ * (1 - æ‰‹çºŒè²»ç‡)
            // æˆ‘å€‘å¸Œæœ›ï¼šè³£å‡ºç¸½æ‹¿å›é‡‘é¡ = è²·å…¥ç¸½æ”¯å‡º
            // æ‰€ä»¥ï¼šè³£å‡ºç¸½åƒ¹ * (1 - rate) = totalBuyCost
            // è³£å‡ºç¸½åƒ¹ = totalBuyCost / (1 - rate)
            // å…©å¹³å–®åƒ¹ = è³£å‡ºç¸½åƒ¹ / è‚¡æ•¸
            
            let breakEvenTotal = 0;
            let breakEvenPrice = 0;
            let percentChange = 0;

            if (shares > 0 && (1 - rateDecimal) > 0) {
                breakEvenTotal = totalBuyCost / (1 - rateDecimal);
                breakEvenPrice = breakEvenTotal / shares;
                
                if (price > 0) {
                    percentChange = ((breakEvenPrice - price) / price) * 100;
                }
            }

            // 3. æ ¼å¼åŒ–é¡¯ç¤º
            const currencyFmt = new Intl.NumberFormat('en-US', {
                style: 'currency',
                currency: 'USD',
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            });

            // é‡å°å–®åƒ¹é¡¯ç¤ºå¤šä¸€é»å°æ•¸é»ï¼Œæ¯”è¼ƒç²¾æº–
            const priceFmt = new Intl.NumberFormat('en-US', {
                style: 'currency',
                currency: 'USD',
                minimumFractionDigits: 3,
                maximumFractionDigits: 3
            });

            principalDisplay.textContent = currencyFmt.format(principal);
            buyFeeDisplay.textContent = currencyFmt.format(buyFee);
            totalCostDisplay.textContent = currencyFmt.format(totalBuyCost);

            breakEvenPriceDisplay.textContent = priceFmt.format(breakEvenPrice);
            percentNeedDisplay.textContent = percentChange.toFixed(3) + '%';
        }
    </script>
</body>
</html>
